#!/bin/sh
# Tune manuals
export MANPATH="/usr/local/man:$MANPATH"

# Fuzzy finder configuration ()
FD_OPTIONS="--follow --hidden --exclude .git --exclude node_modules"
export FZF_DEFAULT_OPTS=" \
    --height 50% --layout=reverse --border=rounded  \
	--scroll-off=1 --info=inline --multi \
    --prompt '∷ ' \
    --pointer ▶ \
    --marker ⇒ \
    --bind='f2:toggle-preview' \
    --bind='ctrl-d:half-page-down,ctrl-u:half-page-up' \
    --bind='ctrl-a:select-all+accept' \
    --bind='ctrl-y:execute-silent(echo {+} | pbcopy)' \
    --color 'fg:#bbccdd,fg+:#ddeeff,bg:#334455,preview-bg:#223344,border:#778899'"

export FZF_DEFAULT_COMMAND="fdfind . $HOME"

export FZF_CTRL_T_COMMAND="fdfind $FD_OPTIONS"
export FZF_CTRL_T_OPTS=" \
    --preview='[[ \$(file --mime {}) =~ 'charset=binary' && ! \$(file --mime {}) =~ 'directory' ]] && file {} || (less -E {}) 2> /dev/null | head -$LINES' \
	--preview-window='right:60%:hidden:wrap'"

export FZF_ALT_C_COMMAND="fdfind --type d $FD_OPTIONS"

export FZF_CTRL_R_OPTS=" \
    --preview 'echo -E {}' --preview-window up:3:hidden:wrap \
    --bind 'ctrl-/:toggle-preview' \
    --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort' \
    --color header:italic \
    --header 'Press Ctrl-Y to copy command into clipboard'"

# Pagers: less, bat etc...
# make less more friendly for non-text input files, see lesspipe(1)
if test -x /usr/bin/lesspipe; then
    eval "$(SHELL=/bin/sh lesspipe)"
fi

export PAGER="less"
# export LESSOPEN="| ~/.lessfilter %s"
export LESSOPEN="|/usr/local/bin/lesspipe.sh %s"
export LESS='-r'
export MANPAGER="sh -c 'col -bx | batcat -l man -p'"
export BAT_PAGER="less -RF"
export EDITOR='vim'
export HISTCONTROL=ignoredups

# enable color support of ls and also add handy aliases
if test -x /usr/bin/dircolors; then
    if test -r ~/.dircolors; then
        eval "$(dircolors -b ~/.dircolors)" 
    else 
        eval "$(dircolors -b)"
    fi
    alias ls='ls --color=auto'
    alias dir='dir --color=auto'
    alias vdir='vdir --color=auto'

    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
fi

# Date and Timezone, Lang, Locale etc.
export TZ='Europe/Moscow'
export LANG=en_US.UTF-8

if test -f "$HOME"/.aliases; then
    # shellcheck source=/dev/null
    . "$HOME/.aliases"
fi

export PATH="$HOME/scripts:$HOME/bin:/usr/local/bin:/usr/local/pgsql/bin:/root/.cargo/bin:$PATH"

# shellcheck source=/dev/null
[ -f "$HOME/.cargo/env" ] && . "$HOME/.cargo/env"

# #colored GCC warnings and errors
export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'
